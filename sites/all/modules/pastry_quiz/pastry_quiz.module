<?php

// TO DO:
// 1. fix everything
// 2. write at least two more questions
// 3. make suggestions based on questions
// Assignment: at least three questions on different pages and at least three unique outcomes for the quiz result page. After that, the content is totally up to you! In fact the quiz can be about anything, as long as it suggests pastries.

function pastry_quiz_menu() {
    $items['quiz'] = array(
        'title' => 'Which pastry should I choose!?',
        'page callback' => 'drupal_get_form',
        'page arguments' => array('start_form'),
        'access callback' => TRUE,
        'type' => MENU_NORMAL_ITEM,
    );

    $items['question_two'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('question_two'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    $items['question_three'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('question_three'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    $items['quiz_results'] = array(
        'title' => 'Quiz Results!',
        'page callback' => 'quiz_success',
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    return $items;
}


function start_form() {
    $form['gluten'] = array(
        '#title' => 'Are you gluten intolerant?',
        '#type' => 'radios',
        '#description' => t(' '),
        '#options' => array(
            t('Yes'),
            t('No'),
            ),
            '#required' => TRUE,
            );

            $form['submit'] = array(
            '#type' => 'submit',
            '#value' => 'submit',
            );

            return $form;
        }

        function question_two() {
            $form['nuts'] = array(
            '#title' => 'Do you have any nut allergies?',
            '#type' => 'radios',
            '#description' => t(' '),
            '#options' => array(
            t('Yes'),
            t('No'),
            ),
            '#required' => TRUE,
            );

            $form['submit'] = array(
            '#type' => 'submit',
            '#value' => 'submit',
            );

            return $form;
        }

        function question_three() {
            $form['bacon'] = array(
            '#title' => 'Do you eat bacon?',
            '#type' => 'radios',
            '#description' => t(' '),
            '#options' => array(
            t('Yes'),
            t('No'),
            ),
            '#required' => TRUE,
            );

            $form['submit'] = array(
            '#type' => 'submit',
            '#value' => 'submit',
            );

            return $form;
        }

        function quiz_success() {
            $gluten = $_SESSION['values']['gluten'];
            // $nuts = $_SESSION['values']['nuts'];
            // $bacon = $_SESSION['values']['bacon'];
            if ($gluten) {
                return '<p> Try one of our amazing gluten-free donuts! </p>';

                // } elseif ($bacon && !$gluten){
                //     return "<p> BACON MAPLE BAR, \'nuf said... </p>";

                } else {
                    return "<p> Our apricot scones are delicious! </p>";
                }
        }

    function start_form_submit($form, &$form_state) {
        $gluten = $form_state['values']['gluten'];
        $_SESSION['gluten'] = $gluten;
        $form_state['redirect'] = 'question_two';
    }

    function question_two_submit($form, &$form_state) {
        $nuts = $form_state['values']['nuts'];
        $_SESSION['nuts'] = $nuts;
        $form_state['redirect'] = 'question_three';
    }

    function question_three_submit($form, &$form_state) {
        //   $form['gluten']['default_value'] = variable_get('comment_preview', 1);
          $bacon = $form_state['values']['bacon'];
          $_SESSION['bacon'] = $bacon;
          $form_state['redirect'] = 'quiz_results';
    }

    // function quiz_form_submit($form, &$form_state) {
    //   $form['gluten']['default_value'] = variable_get('comment_preview', 1);
    //   $gluten = $form_state['values']['gluten'];
    //   $_SESSION['gluten'] = $gluten;
    //   $form_state['redirect'] = 'quiz_results';
    // }
